(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function t(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(a){if(a.ep)return;a.ep=!0;const s=t(a);fetch(a.href,s)}})();function N(n){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);if(!e)throw new Error("Hex code invalid");return{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}}function P(n){return(n.r&248)<<8|(n.g&252)<<3|(n.b&248)>>3}function T(n,e){let t=!0,o=[];if(e.vendorId!==void 0&&n.vendorId!==e.vendorId&&(t=!1,o.push(`Vendor id mismatch: ${n.vendorId}. Expected: ${e.vendorId}`)),e.productId!==void 0&&n.productId!==e.productId&&(t=!1,o.push(`Product id mismatch: ${n.productId}. Expected: ${e.productId}`)),e.usagePage!==void 0){const a=n.collections.map(r=>r.usagePage);a.find(r=>r===e.usagePage)||(t=!1,o.push(`Usage page mismatch: ${a.join()}. Expected: ${e.usagePage}`))}return t?{success:t,value:e}:{success:t,reason:o}}function m(n,e){const t=[];for(const o of e){const a=T(n,o);if(a.success)return a;t.push(...a.reason)}return{success:!1,reason:t}}const A=4919,D=65364,h=12771,f=21,i=6,l=116,S=11,L=30,W=31,G=32,M=4608,$=4624,C=4640,U=4656,x=4864,F=4880,H=4896,B=5376,q=5392,K=5120;function v(n){let{row:e,column:t}=n;return e&=7,t&=31,e<<5|t}function V(...n){for(const e of n)if(e<0||e>255)throw new Error(`Uint8 value is 0..255. Got: ${e}`)}function g(n){return`'${n.productName}' vid: ${n.vendorId.toString(16)} pid: ${n.productId.toString(16)}`}const p={model:"Wooting Two",type:"keyboard",rows:i,columns:f,ledMax:l,v2:!1,smallPackets:!1,layout:"unknown"},j={...p,v2:!0},Y={model:"Wooting Two Lekker Edition",type:"keyboard",rows:i,columns:f,ledMax:l,v2:!0,smallPackets:!1,layout:"unknown"},z={model:"Wooting Two HE (ARM)",type:"keyboard",rows:i,columns:f,ledMax:l,v2:!0,smallPackets:!0,layout:"unknown"},J={model:"Wooting 60HE",type:"keyboard60",rows:i,columns:14,ledMax:l,v2:!0,smallPackets:!1,layout:"unknown"},Q={model:"Wooting 60HE (ARM)",type:"keyboard60",rows:i,columns:14,ledMax:l,v2:!0,smallPackets:!0,layout:"unknown"},X={model:"Wooting 60HE+",type:"keyboard60",rows:i,columns:14,ledMax:l,v2:!0,smallPackets:!0,layout:"unknown"},w={model:"Wooting UwU RGB",type:"keypad3key",rows:5,columns:7,ledMax:18,v2:!0,smallPackets:!0,layout:"unknown"},Z={...w,model:"Wooting UwU",ledMax:0},ee={model:"Wooting 80HE",type:"keyboard80",rows:i,columns:17,ledMax:l,v2:!0,smallPackets:!1,layout:"unknown"},te={[F]:Q,[x]:J,[H]:X,[K]:ee,[U]:z,[C]:p,[$]:Y,[M]:j,[B]:Z,[q]:w};class y{_device;_info;#e;constructor(e,t,o){if(this._device=e,this.#e=t,o?this._info=o:this._info=te[e.productId],!this._info)throw new Error(`Unknown product: ${g(e)}`);if(this._info.smallPackets)throw new Error("Small packet size transfers are not supported - I don't have a keyboard to test with. Sorry.");if(!this._info.v2)throw new Error("Pre-version 2 devices are not supported - I don't have a keyboard to test with. Sorry.")}sendFeature(e,t,o,a,s){if(!this.isOpen)throw new Error("Device not open");V(t,o,a,s);const r=Uint8Array.from([208,218,e,t,o,a,s]);return this._device.sendFeatureReport(0,r)}close(){return this._device.close()}get device(){return this._device}get printableId(){return g(this._device)}get isOpen(){return this._device.opened}get info(){return this._info}get kind(){return this.#e}}function ne(n){if(!n.success)throw Array.isArray(n.reason)?new Error(n.reason.join("; ")):new Error(n.reason)}class b extends y{#e;#t=!1;constructor(e,t,o){super(e,t,o),this.#e=[];for(let a=0;a<this._info.rows;a++)this.#e.push(new Array(this._info.columns))}validateRowCol(e,t){if(e>=this.#e.length)return{success:!1,reason:`Row out of range, max index should be: ${this.#e.length-1}. Got: ${e}`};const o=this.#e[e];return t>=o.length?{success:!1,reason:`Column of of range, max index should be: ${t}. Got: ${t}`}:{success:!0,value:o}}setRgb(e,t){const o=this.validateRowCol(e.row,e.column);o.success?(o.value[e.column]=t,this.#t=!0):ne(o)}setRgbAlt(e,t,o,a,s){this.setRgb({row:e,column:t},{r:o,g:a,b:s})}flushRgbBuffer(e=!1){if(!e&&!this.#t)return;const t=this.#e.map(o=>o.map(s=>{const r=P(s);return[r&255,r>>8]}).flat());return this.#t=!1,this.#n(t)}setRgbSingle(e,t){const o=v(e);return this.sendFeature(L,t.b,t.g,t.r,o)}resetSingle(e){const t=v(e);return this.sendFeature(W,t,0,0,0)}resetAll(){this.sendFeature(G,0,0,0,0)}#n(e){if(!this.isOpen)throw new Error("Device not open");const t=new Uint8Array(256),o=e.flat();return t[0]=208,t[1]=218,t[2]=S,t.set(o,3),this._device.sendReport(0,t)}*keysByRow(){for(let e=0;e<this.rowCount;e++)for(let t=0;t<this.columnCount;t++)yield{row:e,column:t}}*keysByColumn(){for(let e=0;e<this.columnCount;e++)for(let t=0;t<this.rowCount;t++)yield{row:t,column:e}}get rowCount(){return this.info.rows}get columnCount(){return this.info.columns}}class oe{filters=[{usagePage:A,vendorId:h}];create(e){const t=m(e,this.filters);return t.success?{success:!0,value:new b(e,this)}:t}get name(){return"Rgb"}}const ae=[{name:"Escape",value:41},{name:"F1",value:58},{name:"F2",value:59},{name:"F3",value:60},{name:"F4",value:61},{name:"F5",value:62},{name:"F6",value:63},{name:"F7",value:64},{name:"F8",value:65},{name:"F9",value:66},{name:"F10",value:67},{name:"F11",value:68},{name:"F12",value:69},{name:"`",value:53},{name:"1",value:30},{name:"2",value:31},{name:"3",value:32},{name:"4",value:33},{name:"5",value:34},{name:"6",value:35},{name:"7",value:36},{name:"8",value:37},{name:"9",value:38},{name:"0",value:39},{name:"-",value:45},{name:"=",value:46},{name:"Backspace",value:42},{name:"Tab",value:43},{name:"Q",value:20},{name:"W",value:26},{name:"E",value:8},{name:"R",value:21},{name:"T",value:23},{name:"Y",value:28},{name:"U",value:24},{name:"I",value:12},{name:"O",value:18},{name:"P",value:19},{name:"[",value:47},{name:"]",value:48},{name:"Enter",value:40},{name:"Caps Lock",value:57},{name:"A",value:4},{name:"S",value:22},{name:"D",value:7},{name:"F",value:9},{name:"G",value:10},{name:"H",value:11},{name:"J",value:13},{name:"K",value:14},{name:"L",value:15},{name:";",value:51},{name:"'",value:52},{name:"Backslash",value:49},{name:"Left Shift",value:225},{name:"Intl Backslash",value:100},{name:"Z",value:29},{name:"X",value:27},{name:"C",value:6},{name:"V",value:25},{name:"B",value:5},{name:"N",value:17},{name:"M",value:16},{name:",",value:54},{name:".",value:55},{name:"/",value:56},{name:"Right Shift",value:229},{name:"Left Ctrl",value:224},{name:"Left Meta",value:227},{name:"Left Alt",value:226},{name:"Space",value:44},{name:"Right Alt",value:230},{name:"Right Meta",value:231},{name:"Fn",value:1033},{name:"Context Menu",value:101},{name:"Right Ctrl",value:228},{name:"Print Screen",value:70},{name:"Pause",value:72},{name:"Scroll Lock",value:71},{name:"Insert",value:73},{name:"Home",value:74},{name:"Page Up",value:75},{name:"Delete",value:76},{name:"End",value:77},{name:"Page Down",value:78},{name:"Up Arrow",value:82},{name:"Left Arrow",value:80},{name:"Down Arrow",value:81},{name:"Right Arrow",value:79},{name:"Num Lock",value:83},{name:"Numpad /",value:84},{name:"Numpad *",value:85},{name:"Numpad -",value:86},{name:"Numpad 7",value:95},{name:"Numpad 8",value:96},{name:"Numpad 9",value:97},{name:"Numpad +",value:87},{name:"Numpad 4",value:92},{name:"Numpad 5",value:93},{name:"Numpad 6",value:94},{name:"Numpad 1",value:89},{name:"Numpad 2",value:90},{name:"Numpad 3",value:91},{name:"Numpad Enter",value:88},{name:"Numpad 0",value:98},{name:"Numpad .",value:99}],_=new Map;for(const n of ae)_.set(n.value,n.name);class I extends y{oninput;constructor(e,t,o){super(e,t,o),this.oninput=null,e.oninputreport=a=>{const s=[];for(let r=0;r<a.data.byteLength;){const d=a.data.getUint8(r++)<<8|a.data.getUint8(r++);if(d==0)break;const E=a.data.getUint8(r++);s.push({code:d,value:E/255,key:_.get(d)})}this.oninput&&this.oninput({source:this,keys:s})}}close(){return this.device.oninputreport=null,super.close()}}class se{filters=[{usagePage:D,vendorId:h}];create(e){const t=m(e,this.filters);return t.success?{success:!0,value:new I(e,this)}:t}get name(){return"Analog"}}class re{devices=[];#e=!1;#t=[];#n;constructor(e={}){this.#n={rgb:!0,analog:!1,...e},this.#n.rgb&&this.#t.push(new oe),this.#n.analog&&this.#t.push(new se)}async scan(e={}){const t={force:!1,automaticallyConnect:!0,...e};if(this.devices.length>0&&!t.force)return this.devices;if(!("hid"in navigator))throw new Error("WebHID not supported");this.closeAll();for(const o of this.#t){const a=await navigator.hid.requestDevice({filters:o.filters});t.automaticallyConnect&&this.#o(a,o)}return this.devices}async#o(e,t){const o=e.filter(a=>m(a,t.filters).success);for(const a of o){const s=t.create(a);s.success&&(a.opened||await a.open(),this.devices.push(s.value))}}debugDump(){for(const e of this.devices)console.log(`${e.kind}	${e.printableId}`)}async initialise(){if(this.#e)return;this.#e;const e=await navigator.hid.getDevices();for(const t of this.#t)await this.#o(e,t)}*filtersCombined(){for(const e of this.#t)yield*e.filters}*getRgb(){for(const e of this.devices)e instanceof b&&(yield e)}*getAnalog(){for(const e of this.devices)e instanceof I&&(yield e)}closeAll(){for(const e of this.devices)e.close();this.devices=[]}}const ue=n=>new Promise(e=>setTimeout(e,n)),c=[{r:255,g:0,b:0},{r:0,g:255,b:0},{r:0,g:0,b:255},{r:127,g:127,b:0},{r:0,g:127,b:127},{r:127,g:0,b:127}],u=new re({rgb:!0,analog:!0});await u.initialise();async function O(){const n=[...u.getRgb()];if(n.length===0){alert("No RGB devices found");return}const e=n[0];console.log(`Demo buffered output: ${e.printableId}`);for(const t of e.keysByRow())e.setRgb(t,c[t.row%c.length]);e.flushRgbBuffer(),await ue(2e3);for(const t of e.keysByColumn())e.setRgb(t,c[t.column%c.length]);e.flushRgbBuffer(),setTimeout(()=>{e.resetAll()},5e3)}async function ie(n,e){const t=[...u.getRgb()];if(t.length===0){alert("No RGB devices found");return}const o=t[0];console.log(`Demo single output: ${o.printableId} pos: ${n.row}x${n.column} colour: ${e.r},${e.g},${e.b}`),o.setRgbSingle(n,e),setTimeout(()=>{o.resetAll()},5e3)}function k(n){const e=document.querySelector("#scanResults");if(n.length===0){e.innerHTML="No devices found.";return}else{let t=u.devices.map(o=>`<li>${o.printableId} (${o.kind.name})</li>`).join("");e.innerHTML=`<ul>${t}</ul>`}}function le(n){const e=document.querySelector("#keys");if(n.keys.length===0)e.innerHTML="<i>No keys</i>";else{const t=n.keys.map(o=>`<li>${o.key} (${o.code}) = ${o.value.toPrecision(2)}</li>`);e.innerHTML=`<ul>${t.join("")}</ul>`}}document.querySelector("#btnScan")?.addEventListener("click",async()=>{const n=await u.scan();k(n),setTimeout(()=>{O()},200);for(const e of u.getAnalog())e.oninput=le});document.querySelector("#btnDemoBuffered")?.addEventListener("click",async()=>{await u.scan(),O()});document.querySelector("#btnDemoSingle")?.addEventListener("click",async n=>{await u.scan(),R(),n.preventDefault()});document.querySelector("#btnReset")?.addEventListener("click",()=>{for(const n of u.getRgb())n.resetAll()});document.querySelector("#colour")?.addEventListener("change",async n=>{await u.scan(),R(),n.preventDefault()});document.addEventListener("keydown",n=>{n.preventDefault(),n.stopPropagation()});function R(){const n={row:document.querySelector("#singleRow").valueAsNumber,column:document.querySelector("#singleColumn").valueAsNumber},e=N(document.querySelector("#colour").value);ie(n,e)}k(u.devices);
